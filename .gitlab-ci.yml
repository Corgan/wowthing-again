include:
  - '/_magic/build.yml'
  - '/_magic/deploy.yml'

image: docker:latest

services:
  - docker:dind

variables:
  DOCKER_DRIVER: overlay2

stages:
  - build
  - deploy

# Wowthing.Backend
backend-build:
  extends: .build
  variables:
    DOCKER_FILE: src/Wowthing.Backend/Dockerfile

#backend-deploy:
#  extends: .deploy


# Wowthing.Web
web-build:
  extends: .build
  variables:
    DOCKER_FILE: src/Wowthing.Web/Dockerfile

web-deploy:
  extends: .deploy
  needs: ["web-build"]
  variables:
    DEPLOYMENT_FILE: _magic/web-deployment.yml
